import { prisma } from '@/lib/db'; import bcrypt from 'bcryptjs'; export async function POST(req:Request){ const f=await req.formData(); const name=String(f.get('name')||''); const email=String(f.get('email')||''); const phone=String(f.get('phone')||''); const password=String(f.get('password')||''); if(!email||!password) return new Response('Bad request',{status:400}); if(await prisma.user.findUnique({where:{email}})) return new Response('Email exists',{status:409}); await prisma.user.create({data:{name,email,phone,password:await bcrypt.hash(password,10),role:'PATIENT'}}); return new Response('OK'); }
